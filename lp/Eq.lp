require open pp2lp.B;

// variable equality: uses meta-level identity for `id` (no string equality
// available), and structural recursion for `â¨¾`.
rule var_eq (id $s) (id $s) â†ª true
with var_eq ($x â¨¾ $y) ($z â¨¾ $w) â†ª (var_eq $x $z) and (var_eq $y $w)
with var_eq (id _) (id _) â†ª false
with var_eq (id _) (_ â¨¾ _) â†ª false
with var_eq (_ â¨¾ _) (id _) â†ª false;

// expression equality.
rule exp_eq (#var $x) (#var $y) â†ª var_eq $x $y
with exp_eq ($E â†¦ $F) ($G â†¦ $H)
  â†ª (exp_eq $E $G) and (exp_eq $F $H)
with exp_eq (choice $s) (choice $t) â†ª exp_eq $s $t
with exp_eq ($s Ã— $t) ($u Ã— $v)
  â†ª (exp_eq $s $u) and (exp_eq $t $v)
with exp_eq (ğ’« $s) (ğ’« $t) â†ª exp_eq $s $t
with exp_eq (big) (big) â†ª true
with exp_eq (comp $x $P) (comp $y $Q)
  â†ª (var_eq $x $y) and (prd_eq $P $Q)
// cross-constructor cases:
with exp_eq (#var _) (_ â†¦ _) â†ª false
with exp_eq (#var _) (_ Ã— _) â†ª false
with exp_eq (#var _) (ğ’« _) â†ª false
with exp_eq (#var _) big â†ª false
with exp_eq (#var _) (choice _) â†ª false
with exp_eq (#var _) (comp _ _) â†ª false
with exp_eq (_ â†¦ _) (#var _) â†ª false
with exp_eq (_ â†¦ _) (_ Ã— _) â†ª false
with exp_eq (_ â†¦ _) (ğ’« _) â†ª false
with exp_eq (_ â†¦ _) big â†ª false
with exp_eq (_ â†¦ _) (choice _) â†ª false
with exp_eq (_ â†¦ _) (comp _ _) â†ª false
with exp_eq (_ Ã— _) (#var _) â†ª false
with exp_eq (_ Ã— _) (_ â†¦ _) â†ª false
with exp_eq (_ Ã— _) (ğ’« _) â†ª false
with exp_eq (_ Ã— _) big â†ª false
with exp_eq (_ Ã— _) (choice _) â†ª false
with exp_eq (_ Ã— _) (comp _ _) â†ª false
with exp_eq (ğ’« _) (#var _) â†ª false
with exp_eq (ğ’« _) (_ â†¦ _) â†ª false
with exp_eq (ğ’« _) (_ Ã— _) â†ª false
with exp_eq (ğ’« _) big â†ª false
with exp_eq (ğ’« _) (choice _) â†ª false
with exp_eq (ğ’« _) (comp _ _) â†ª false
with exp_eq big (#var _) â†ª false
with exp_eq big (_ â†¦ _) â†ª false
with exp_eq big (_ Ã— _) â†ª false
with exp_eq big (ğ’« _) â†ª false
with exp_eq big (choice _) â†ª false
with exp_eq big (comp _ _) â†ª false
with exp_eq (choice _) (#var _) â†ª false
with exp_eq (choice _) (_ â†¦ _) â†ª false
with exp_eq (choice _) (_ Ã— _) â†ª false
with exp_eq (choice _) (ğ’« _) â†ª false
with exp_eq (choice _) big â†ª false
with exp_eq (choice _) (comp _ _) â†ª false
with exp_eq (comp _ _) (#var _) â†ª false
with exp_eq (comp _ _) (_ â†¦ _) â†ª false
with exp_eq (comp _ _) (_ Ã— _) â†ª false
with exp_eq (comp _ _) (ğ’« _) â†ª false
with exp_eq (comp _ _) big â†ª false
with exp_eq (comp _ _) (choice _) â†ª false;

// predicate equality.
rule prd_eq ($p âˆ§ $q) ($r âˆ§ $s)
  â†ª (prd_eq $p $r) and (prd_eq $q $s)
with prd_eq ($p âˆ¨ $q) ($r âˆ¨ $s)
  â†ª (prd_eq $p $r) and (prd_eq $q $s)
with prd_eq ($p â‡’ $q) ($r â‡’ $s)
  â†ª (prd_eq $p $r) and (prd_eq $q $s)
with prd_eq ($p â‡” $q) ($r â‡” $s)
  â†ª (prd_eq $p $r) and (prd_eq $q $s)
with prd_eq (Â¬ $p) (Â¬ $q)
  â†ª (prd_eq $p $q)
with prd_eq (âˆ€ $x $p) (âˆ€ $y $q)
  â†ª (var_eq $x $y) and (prd_eq $p $q)
with prd_eq (âˆƒ $x $p) (âˆƒ $y $q)
  â†ª (var_eq $x $y) and (prd_eq $p $q)
with prd_eq (â™¢ $x $p) (â™¢ $y $q)
  â†ª (var_eq $x $y) and (prd_eq $p $q)
with prd_eq (â™¡ $x $p) (â™¡ $y $q)
  â†ª (var_eq $x $y) and (prd_eq $p $q)
with prd_eq ($e = $f) ($g = $h)
  â†ª (exp_eq $e $g) and (exp_eq $f $h)
with prd_eq ($e âˆˆ $s) ($f âˆˆ $t)
  â†ª (exp_eq $e $f) and (exp_eq $s $t)
// cross-constructor cases:
with prd_eq (Â¬ _) (_ âˆ§ _) â†ª false
with prd_eq (Â¬ _) (_ âˆ¨ _) â†ª false
with prd_eq (Â¬ _) (_ â‡’ _) â†ª false
with prd_eq (Â¬ _) (_ â‡” _) â†ª false
with prd_eq (Â¬ _) (_ = _) â†ª false
with prd_eq (Â¬ _) (_ âˆˆ _) â†ª false
with prd_eq (Â¬ _) (âˆ€ _ _) â†ª false
with prd_eq (Â¬ _) (âˆƒ _ _) â†ª false
with prd_eq (Â¬ _) (â™¢ _ _) â†ª false
with prd_eq (Â¬ _) (â™¡ _ _) â†ª false
with prd_eq (_ âˆ§ _) (Â¬ _) â†ª false
with prd_eq (_ âˆ§ _) (_ âˆ¨ _) â†ª false
with prd_eq (_ âˆ§ _) (_ â‡’ _) â†ª false
with prd_eq (_ âˆ§ _) (_ â‡” _) â†ª false
with prd_eq (_ âˆ§ _) (_ = _) â†ª false
with prd_eq (_ âˆ§ _) (_ âˆˆ _) â†ª false
with prd_eq (_ âˆ§ _) (âˆ€ _ _) â†ª false
with prd_eq (_ âˆ§ _) (âˆƒ _ _) â†ª false
with prd_eq (_ âˆ§ _) (â™¢ _ _) â†ª false
with prd_eq (_ âˆ§ _) (â™¡ _ _) â†ª false
with prd_eq (_ âˆ¨ _) (Â¬ _) â†ª false
with prd_eq (_ âˆ¨ _) (_ âˆ§ _) â†ª false
with prd_eq (_ âˆ¨ _) (_ â‡’ _) â†ª false
with prd_eq (_ âˆ¨ _) (_ â‡” _) â†ª false
with prd_eq (_ âˆ¨ _) (_ = _) â†ª false
with prd_eq (_ âˆ¨ _) (_ âˆˆ _) â†ª false
with prd_eq (_ âˆ¨ _) (âˆ€ _ _) â†ª false
with prd_eq (_ âˆ¨ _) (âˆƒ _ _) â†ª false
with prd_eq (_ âˆ¨ _) (â™¢ _ _) â†ª false
with prd_eq (_ âˆ¨ _) (â™¡ _ _) â†ª false
with prd_eq (_ â‡’ _) (Â¬ _) â†ª false
with prd_eq (_ â‡’ _) (_ âˆ§ _) â†ª false
with prd_eq (_ â‡’ _) (_ âˆ¨ _) â†ª false
with prd_eq (_ â‡’ _) (_ â‡” _) â†ª false
with prd_eq (_ â‡’ _) (_ = _) â†ª false
with prd_eq (_ â‡’ _) (_ âˆˆ _) â†ª false
with prd_eq (_ â‡’ _) (âˆ€ _ _) â†ª false
with prd_eq (_ â‡’ _) (âˆƒ _ _) â†ª false
with prd_eq (_ â‡’ _) (â™¢ _ _) â†ª false
with prd_eq (_ â‡’ _) (â™¡ _ _) â†ª false
with prd_eq (_ â‡” _) (Â¬ _) â†ª false
with prd_eq (_ â‡” _) (_ âˆ§ _) â†ª false
with prd_eq (_ â‡” _) (_ âˆ¨ _) â†ª false
with prd_eq (_ â‡” _) (_ â‡’ _) â†ª false
with prd_eq (_ â‡” _) (_ = _) â†ª false
with prd_eq (_ â‡” _) (_ âˆˆ _) â†ª false
with prd_eq (_ â‡” _) (âˆ€ _ _) â†ª false
with prd_eq (_ â‡” _) (âˆƒ _ _) â†ª false
with prd_eq (_ â‡” _) (â™¢ _ _) â†ª false
with prd_eq (_ â‡” _) (â™¡ _ _) â†ª false
with prd_eq (_ = _) (Â¬ _) â†ª false
with prd_eq (_ = _) (_ âˆ§ _) â†ª false
with prd_eq (_ = _) (_ âˆ¨ _) â†ª false
with prd_eq (_ = _) (_ â‡’ _) â†ª false
with prd_eq (_ = _) (_ â‡” _) â†ª false
with prd_eq (_ = _) (_ âˆˆ _) â†ª false
with prd_eq (_ = _) (âˆ€ _ _) â†ª false
with prd_eq (_ = _) (âˆƒ _ _) â†ª false
with prd_eq (_ = _) (â™¢ _ _) â†ª false
with prd_eq (_ = _) (â™¡ _ _) â†ª false
with prd_eq (_ âˆˆ _) (Â¬ _) â†ª false
with prd_eq (_ âˆˆ _) (_ âˆ§ _) â†ª false
with prd_eq (_ âˆˆ _) (_ âˆ¨ _) â†ª false
with prd_eq (_ âˆˆ _) (_ â‡’ _) â†ª false
with prd_eq (_ âˆˆ _) (_ â‡” _) â†ª false
with prd_eq (_ âˆˆ _) (_ = _) â†ª false
with prd_eq (_ âˆˆ _) (âˆ€ _ _) â†ª false
with prd_eq (_ âˆˆ _) (âˆƒ _ _) â†ª false
with prd_eq (_ âˆˆ _) (â™¢ _ _) â†ª false
with prd_eq (_ âˆˆ _) (â™¡ _ _) â†ª false
with prd_eq (âˆ€ _ _) (Â¬ _) â†ª false
with prd_eq (âˆ€ _ _) (_ âˆ§ _) â†ª false
with prd_eq (âˆ€ _ _) (_ âˆ¨ _) â†ª false
with prd_eq (âˆ€ _ _) (_ â‡’ _) â†ª false
with prd_eq (âˆ€ _ _) (_ â‡” _) â†ª false
with prd_eq (âˆ€ _ _) (_ = _) â†ª false
with prd_eq (âˆ€ _ _) (_ âˆˆ _) â†ª false
with prd_eq (âˆ€ _ _) (âˆƒ _ _) â†ª false
with prd_eq (âˆ€ _ _) (â™¢ _ _) â†ª false
with prd_eq (âˆ€ _ _) (â™¡ _ _) â†ª false
with prd_eq (âˆƒ _ _) (Â¬ _) â†ª false
with prd_eq (âˆƒ _ _) (_ âˆ§ _) â†ª false
with prd_eq (âˆƒ _ _) (_ âˆ¨ _) â†ª false
with prd_eq (âˆƒ _ _) (_ â‡’ _) â†ª false
with prd_eq (âˆƒ _ _) (_ â‡” _) â†ª false
with prd_eq (âˆƒ _ _) (_ = _) â†ª false
with prd_eq (âˆƒ _ _) (_ âˆˆ _) â†ª false
with prd_eq (âˆƒ _ _) (âˆ€ _ _) â†ª false
with prd_eq (âˆƒ _ _) (â™¢ _ _) â†ª false
with prd_eq (âˆƒ _ _) (â™¡ _ _) â†ª false
with prd_eq (â™¢ _ _) (Â¬ _) â†ª false
with prd_eq (â™¢ _ _) (_ âˆ§ _) â†ª false
with prd_eq (â™¢ _ _) (_ âˆ¨ _) â†ª false
with prd_eq (â™¢ _ _) (_ â‡’ _) â†ª false
with prd_eq (â™¢ _ _) (_ â‡” _) â†ª false
with prd_eq (â™¢ _ _) (_ = _) â†ª false
with prd_eq (â™¢ _ _) (_ âˆˆ _) â†ª false
with prd_eq (â™¢ _ _) (âˆ€ _ _) â†ª false
with prd_eq (â™¢ _ _) (âˆƒ _ _) â†ª false
with prd_eq (â™¢ _ _) (â™¡ _ _) â†ª false
with prd_eq (â™¡ _ _) (Â¬ _) â†ª false
with prd_eq (â™¡ _ _) (_ âˆ§ _) â†ª false
with prd_eq (â™¡ _ _) (_ âˆ¨ _) â†ª false
with prd_eq (â™¡ _ _) (_ â‡’ _) â†ª false
with prd_eq (â™¡ _ _) (_ â‡” _) â†ª false
with prd_eq (â™¡ _ _) (_ = _) â†ª false
with prd_eq (â™¡ _ _) (_ âˆˆ _) â†ª false
with prd_eq (â™¡ _ _) (âˆ€ _ _) â†ª false
with prd_eq (â™¡ _ _) (âˆƒ _ _) â†ª false
with prd_eq (â™¡ _ _) (â™¢ _ _) â†ª false;
