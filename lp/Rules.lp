require open Logic.U.Set Logic.U.Prop Logic.U.Arrow Logic.U.Inf;
require open pp2lp.Prelude pp2lp.Syntax;

// ----------------------------------------------
// 5.1. Conjunction
// ----------------------------------------------
symbol AND1 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù not Q => R) ‚§≥
    ‚ñ∑ (H ‚üù not P => R) ‚§≥
    ‚ñ∑ (H ‚üù not (P and Q) => R)
  );

symbol AND2 [H : El (list prd)] [P Q : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => not Q) ‚§≥
    ‚ñ∑ (H ‚üù not (P and Q))
  );

symbol AND2' [H : El (list prd)] [P Q : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => not Q) ‚§≥
    ‚ñ∑ (H ‚üù not (P and Q))
  );

symbol AND3 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => (Q => R)) ‚§≥
    ‚ñ∑ (H ‚üù (P and Q) => R)
  );

symbol AND4 [H : El (list prd)] [P Q : El prd] :
  El (
    ‚ñ∑ (H ‚üù Q) ‚§≥
    ‚ñ∑ (H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù (P and Q))
  );

symbol AND5 [H : El (list prd)] [P R A B : El prd] :
  El (
    (A ‚àà unfold_conj P) ‚áõ
    ‚ñ∑ (H ‚üù fold_conj (replace (A => B) B (unfold_conj P)) => R) ‚§≥
    ‚ñ∑ (H ‚üù P => R)
);


// ----------------------------------------------
// 5.2. Disjunction
// ----------------------------------------------
symbol OR1 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù not P => (not Q => R)) ‚§≥
    ‚ñ∑ (H ‚üù not (P or Q) => R)
  );

symbol OR2 [H : El (list prd)] [P Q : El prd] :
  El (
    ‚ñ∑ (H ‚üù not Q) ‚§≥
    ‚ñ∑ (H ‚üù not P) ‚§≥
    ‚ñ∑ (H ‚üù not (P or Q))
  );

symbol OR3 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù Q => R) ‚§≥
    ‚ñ∑ (H ‚üù P => R) ‚§≥
    ‚ñ∑ (H ‚üù (P or Q) => R)
  );

symbol OR4 [H : El (list prd)] [P Q : El prd] :
  El (
    ‚ñ∑ (H ‚üù not P => Q) ‚§≥
    ‚ñ∑ (H ‚üù (P or Q))
  );


// ----------------------------------------------
// 5.3. Implication
// ----------------------------------------------
symbol IMP1 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => (not Q => R)) ‚§≥
    ‚ñ∑ (H ‚üù not (P => Q) => R)
  );

symbol IMP2 [H : El (list prd)] [P Q : El prd] :
  El (
    ‚ñ∑ (H ‚üù not Q) ‚§≥
    ‚ñ∑ (H ‚üù P) ‚§≥ // This is "H ‚ä¢ P" in the antecedent
    ‚ñ∑ (H ‚üù not (P => Q))
  );

symbol IMP3 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù Q => R) ‚§≥
    ‚ñ∑ (H ‚üù not(P) => R) ‚§≥
    ‚ñ∑ (H ‚üù (P => Q) => R)
  );

symbol IMP4 [H : El (list prd)] [P Q : El prd] :
  El (
    ‚ñ∑ (P ‚à∑ H ‚üù Q) ‚§≥
    ‚ñ∑ (H ‚üù P => Q)
  );

symbol IMP5 [H : El (list prd)] [P Q : El prd] :
  El (
    (P ‚àà H) ‚áõ
    ‚ñ∑ (H ‚üù Q) ‚§≥
    ‚ñ∑ (H ‚üù P => Q)
  );

symbol IMP4' [H : El (list prd)] [P Q R S : El prd] :
  El (
    ((P ‚à∑ H ‚üù Q) ‚üø R) ‚§≥
    ((H ‚üù P => Q) ‚üø (P => R))
  );


// ----------------------------------------------
// 5.4. Equivalence
// ----------------------------------------------
symbol EQV1 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => (not Q => R)) ‚§≥
    ‚ñ∑ (H ‚üù not P => (Q => R)) ‚§≥
    ‚ñ∑ (H ‚üù not (P <=> Q) => R)
  );

symbol EQV2 [H : El (list prd)] [P Q : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => not Q) ‚§≥
    ‚ñ∑ (H ‚üù not Q => P) ‚§≥
    ‚ñ∑ (H ‚üù not (P <=> Q))
  );

symbol EQV3 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => (Q => R)) ‚§≥
    ‚ñ∑ (H ‚üù not P => (not Q => R)) ‚§≥
    ‚ñ∑ (H ‚üù (P <=> Q) => R)
  );

symbol EQV4 [H : El (list prd)] [P Q : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => Q) ‚§≥
    ‚ñ∑ (H ‚üù Q => P) ‚§≥
    ‚ñ∑ (H ‚üù (P <=> Q))
  );


// ----------------------------------------------
// 5.5. Negation
// ----------------------------------------------
symbol NOT1 [H : El (list prd)] [P R : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => R) ‚§≥
    ‚ñ∑ (H ‚üù not not P => R)
  );

symbol NOT2 [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù not not P)
  );


// ----------------------------------------------
// 5.6. Axioms
// ----------------------------------------------
symbol AXM1 [H : El (list prd)] [P Q : El prd] :
  El (
    (not P ‚àà H) ‚áõ
    ‚ñ∑ (H ‚üù P => Q)
  );

symbol AXM2 [H : El (list prd)] [P Q : El prd] :
  El (
    (P ‚àà H) ‚áõ
    ‚ñ∑ (H ‚üù not P => Q)
  );

symbol AXM3 [H : El (list prd)] [P : El prd] :
  El (
    (P ‚àà H) ‚áõ
    ‚ñ∑ (H ‚üù P)
  );

symbol AXM4 [H : El (list prd)] [P R : El prd] :
  El (
    (R ‚àà H) ‚áõ
    ‚ñ∑ (H ‚üù P => R)
  );

symbol AXM5 [H : El (list prd)] [P Q R : El prd] :
  El (
    (not Q ‚àà H) ‚áõ
    ‚ñ∑ (H ‚üù P => (Q => R))
  );

symbol AXM6 [H : El (list prd)] [P Q R : El prd] :
  El (
    (Q ‚àà H) ‚áõ
    ‚ñ∑ (H ‚üù P => (not Q => R))
  );

symbol AXM7 [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => P)
  );

symbol AXM8 [H : El (list prd)] [P R : El prd] :
  El (
    (R ‚àà unfold_conj P) ‚áõ
    ‚ñ∑ (H ‚üù P => R)
  );

symbol AXM9 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [Q : El prd] [x : El idt] [E : El exp] :
  El (
    (‚àÄ1 x (not (VRAI and P (var x))) ‚àà H) ‚áõ
    ‚ñ∑ (H ‚üù P E => Q)
  );


// ----------------------------------------------
// 5.7. Universal quantification
// ----------------------------------------------
symbol ALL1 [H : El (list prd)] [x y : El idt] [P : El (exp ‚§≥ exp ‚§≥ prd)] [R : El prd] :
  El (
    ¬¨ (x ‚â£ y) ‚áõ
    ‚ñ∑ (H ‚üù (not (‚àÄ2 x y (P (var x) (var y)))) => R) ‚§≥
    ‚ñ∑ (H ‚üù (not (‚àÄ1 x (‚àÄ1 y (P (var x) (var y))))) => R)
  );

symbol ALL2 [H : El (list prd)] [x y : El idt] [P : El (exp ‚§≥ exp ‚§≥ prd)] :
  El (
    ¬¨ (x ‚â£ y) ‚áõ
    ‚ñ∑ (H ‚üù (not (‚àÄ2 x y (P (var x) (var y))))) ‚§≥
    ‚ñ∑ (H ‚üù (not (‚àÄ1 x (‚àÄ1 y (P (var x) (var y))))))
  );

symbol ALL3 [H : El (list prd)] [x y : El idt] [P : El (exp ‚§≥ exp ‚§≥ prd)] [R : El prd] :
  El (
    ¬¨ (x ‚â£ y) ‚áõ
    ‚ñ∑ (H ‚üù (‚àÄ2 x y (P (var x) (var y))) => R) ‚§≥
    ‚ñ∑ (H ‚üù (‚àÄ1 x (‚àÄ1 y (P (var x) (var y)))) => R)
  );

symbol ALL4 [x y : El idt] [H : El (list prd)] [P : El (exp ‚§≥ exp ‚§≥ prd)] :
  El (
    ¬¨ (x ‚â£ y) ‚áõ
    ‚ñ∑ (H ‚üù (‚àÄ2 x y (P (var x) (var y)))) ‚§≥
    ‚ñ∑ (H ‚üù (‚àÄ1 x (‚àÄ1 y (P (var x) (var y)))))
  );

symbol ALL5 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [x : El idt] [R : El prd] :
  El (
    ‚ñ∑ (H ‚üù ‚àÄ1 x (not (P (var x) => R))) ‚§≥
    ‚ñ∑ (H ‚üù (not (‚àÄ1 x (P (var x)))) => R)
  );

symbol ALL6 [H : El (list prd)] [P : El prd] [xs : El vrb] :
  El (
    ‚ñ∑ (H ‚üù ! xs P => FAUX) ‚§≥
    ‚ñ∑ (H ‚üù not (! xs P))
  );

symbol ALL7 [H : El (list prd)] [P R : El (exp ‚§≥ prd)] [Q : El prd] [x : El idt]:
  El (
    ((H ‚üù P (var x)) ‚üø R) ‚§≥
    ‚ñ∑ (H ‚üù (‚ô¢1 x (R (var x))) => Q) ‚§≥
    ‚ñ∑ (H ‚üù (‚àÄ1 x (P (var x))) => Q)
  );

symbol ALL8 [H : El (list prd)] [P : El prd] [xs : El vrb] :
  El (
    ‚ñ∑ (H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù ! xs P)
  );

symbol ALL9 [H : El (list prd)] [T : El (exp ‚§≥ prd)] [Q : El prd] :
  El (
    ‚ñ∑ ((! T) ‚à∑ H ‚üù Q) ‚§≥
    ‚ñ∑ (H ‚üù ‚ô° T => Q)
  );

symbol ALL7' [H : El (list prd)] [P Q R S : El prd] :
  El (
    Prf ((H ‚üù P) ‚üø R) ‚§≥
    Prf ((H ‚üù (`‚ô¢ x, R) => Q) ‚üø S) ‚§≥
    Prf ((H ‚üù (`! x, P) => Q) ‚üø S)
  );

symbol ALL8' [H : El (list prd)] [P Q : El prd] :
  El (
    Prf ((H ‚üù P) ‚üø Q) ‚§≥
    Prf ((H ‚üù (`! x, P)) ‚üø (`! x, Q))
  );

symbol ALL9' [H : El (list prd)] [P : El (exp ‚§≥ prd)] [Q R : El prd] :
  El (
    Prf (((! P) ‚à∑ H ‚üù Q) ‚üø R) ‚§≥
    Prf ((H ‚üù (‚ô° P) => Q) ‚üø (! P) => R)
  );

// (??) redunant rules due to HOAS
symbol ALL5_1 [H : El (list prd)] [P R : El prd] : TYPE;
symbol ALL7_1 [H : El (list prd)] [P Q R S A : El prd] : TYPE;
symbol ALL7'_1 [H : El (list prd)] [P Q R S A : El prd] : TYPE;
symbol ALL8'_1 [H : El (list prd)] [P Q : El prd] : TYPE;

// ----------------------------------------------
// 5.8. Existential quantification
// ----------------------------------------------

symbol XST1 [x y : El idt] [H : El (list prd)] [P R : El prd] :
  El (
    ‚ñ∑ (H ‚üù not (`# x, `# y, P) => R) ‚§≥
    ‚ñ∑ (H ‚üù not (`# x, `# y, P) => R)
  );

symbol XST2 [x y : El idt] [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù not (`# x, `# y, P)) ‚§≥
    ‚ñ∑ (H ‚üù not (`# x, `# y, P))
  );

symbol XST3 [x y : El idt] [H : El (list prd)] [P R : El prd] :
  El (
    ‚ñ∑ (H ‚üù (`# x, `# y, P) => R) ‚§≥
    ‚ñ∑ (H ‚üù (`# x, `# y, P) => R)
  );

symbol XST4 [x y : El idt] [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù `# x, `# y, P) ‚§≥
    ‚ñ∑ (H ‚üù `# x, `# y, P)
  );

symbol XST5 [x : El idt] [H : El (list prd)] [P R : El prd] :
  El (
    ‚ñ∑ (H ‚üù (`! x, not P) => R) ‚§≥
    ‚ñ∑ (H ‚üù not (`# x, P) => R)
  );

symbol XST5_1 [x : El idt] [H : El (list prd)] [P R : El prd] :
  El (
    ‚ñ∑ (H ‚üù (`! x, P) => R) ‚§≥
    ‚ñ∑ (H ‚üù not (`# x, not P) => R)
  );

symbol XST6 [x : El idt] [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù `! x, not P) ‚§≥
    ‚ñ∑ (H ‚üù not (`# x, P))
  );

symbol XST6_1 [x : El idt] [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù `! x, P) ‚§≥
    ‚ñ∑ (H ‚üù not (`# x, not P))
  );

symbol XST7 [x : El idt] [H : El (list prd)] [P R Q : El prd] :
  El (
    ‚ñ∑ (H ‚üù `! x, (P => R)) ‚§≥
    ‚ñ∑ (H ‚üù (`# x, P) => R)
  );

symbol XST8 [x y : El idt] [H : El (list prd)] [P R A : El prd] :
  El (
    Prf ((H ‚üù not P) ‚üø R) ‚§≥
    ‚ñ∑ (H ‚üù (`! x, R) => VRAI) ‚§≥
    ‚ñ∑ (H ‚üù (`# x, P))
  );

// redunant rules.
symbol XST7_1 [x : El idt] [H : El (list prd)] [P R Q : El prd] : TYPE;
symbol XST8_1 [x y : El idt] [H : El (list prd)] [P R A : El prd] : TYPE;

// ----------------------------------------------
// 5.9. Vrai et Faux
// ----------------------------------------------
symbol VR1 [H : El (list prd)] [R : El prd] :
  El (
    ‚ñ∑ (H ‚üù not VRAI => R)
  );

symbol VR2 [H : El (list prd)] :
  El (
    ‚ñ∑ (H ‚üù VRAI) ‚§≥
    ‚ñ∑ (H ‚üù not VRAI)
  );

symbol VR3 [H : El (list prd)] [R : El prd] :
  El (
    ‚ñ∑ (H ‚üù R) ‚§≥
    ‚ñ∑ (H ‚üù VRAI => R)
  );

symbol VR4 [H : El (list prd)] [R : El prd] :
  El (
    ‚ñ∑ (H ‚üù VRAI)
  );

symbol FX1 [H : El (list prd)] [R : El prd] :
  El (
    ‚ñ∑ (H ‚üù R) ‚§≥
    ‚ñ∑ (H ‚üù not VRAI => R)
  );

symbol FX2 [H : El (list prd)] [R : El prd] :
  El (
    ‚ñ∑ (H ‚üù not VRAI)
  );

symbol FX3 [H : El (list prd)] [R : El prd] :
  El (
    ‚ñ∑ (H ‚üù VRAI => R)
  );


// ----------------------------------------------
// 5.10. STOP rules
// ----------------------------------------------
symbol STOP [H : El (list prd)] [P : El prd] :
  El (
    Prf (¬¨ (P ‚âà FAUX)) ‚§≥
    ‚ñ∑ (H ‚üù not P => FAUX) ‚§≥
    ‚ñ∑ (H ‚üù P)
  );

symbol STOP' [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù P) ‚§≥
    return P
  );

// ----------------------------------------------
// 5.11 INS rule
// ----------------------------------------------
symbol ‚≠Ü : El (list prd ‚§≥ prd ‚§≥ prd);
notation ‚≠Ü infix 5;

rule (nil ‚≠Ü $p) ‚Ü™ $p
with (($q ‚à∑ $qs) ‚≠Ü $p) ‚Ü™ $q => ($qs ‚≠Ü $p);

symbol INS [H Q : El (list prd)] :
  El (
    ‚ñ∑ (H ‚üù Q ‚≠Ü FAUX) ‚§≥
    ‚ñ∑ (H ‚üù FAUX)
  );

// ----------------------------------------------
// 5.12. Normalization rules
// ----------------------------------------------
symbol NRM1 [H : El (list prd)] [P S : El prd] [xs : El vrb] :
  El (
    ‚ñ∑ (H ‚üù P => S) ‚§≥
    ‚ñ∑ (H ‚üù (‚ô¢ xs P) => S)
  );

symbol NRM2 [H : El (list prd)] [P Q S : El prd] :
  El (
    ‚ñ∑ (H ‚üù P => (`‚ô¢ x, Q) => S) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P => Q) => S)
  );

symbol NRM3 [H : El (list prd)] [P Q S : El prd] :
  El (
    Prf (¬¨ (Q ‚âà FAUX)) ‚§≥
    ‚ñ∑ (H ‚üù (Q => S) and ((`! x, not P) => S)) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P => Q) => S)
  );

symbol NRM4 [H : El (list prd)] [P Q R S : El prd] :
  El (
    ‚ñ∑ (H ‚üù (Q => `‚ô¢ x, (P => R)) => S) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P => (Q => R)) => S)
  );

symbol NRM5 [H : El (list prd)] [P Q R S : El prd] :
  El (
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P and Q => R) => S) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P => (Q => R)) => S)
  );

symbol NRM6 [H : El (list prd)] [P Q R S : El prd] :
  El (
    ‚ñ∑ (H ‚üù `‚ô¢ x, (R => P) => (`‚ô¢ x, (R => Q) => S)) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (R => P and Q) => S)
  );

symbol NRM7 [H : El (list prd)] [P Q S : El prd] :
  El (
    ‚ñ∑ (H ‚üù (`‚ô¢ x, P) => ((`‚ô¢ x, Q) => S)) ‚§≥
    ‚ñ∑ (H ‚üù (`‚ô¢ x, (P and Q) => S))
  );

symbol NRM8 [H : El (list prd)] [Q S : El prd] :
  El (
    ‚ñ∑ (H ‚üù (`‚ô¢ x, `‚ô¢ y, Q) => S) ‚§≥
    ‚ñ∑ (H ‚üù (`‚ô¢ x, `! y, Q) => S)
  );

symbol NRM9 [H : El (list prd)] [P Q S : El prd] :
  El (
    ‚ñ∑ (H ‚üù `‚ô¢ x, `‚ô¢ y, (P => Q) => S) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P => `! y, Q) => S)
  );

symbol NRM10 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù `‚ô° x, not (P and Q) => R) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P and Q => FAUX) => R)
  );

symbol NRM11 [H : El (list prd)] [P R : El prd] :
  El (
    ‚ñ∑ (H ‚üù `‚ô° x, not (VRAI and P) => R) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P => FAUX) => R)
  );

symbol NRM12 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù `‚ô° x, not (P and Q) => R) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P => not Q) => R)
  );

symbol NRM13 [H : El (list prd)] [P Q R : El prd] :
  El (
    ‚ñ∑ (H ‚üù `‚ô° x, not (P and not Q) => R) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô¢ x, (P => Q) => R)
  );

symbol NRM14 [H : El (list prd)] [P R : El prd] :
  El (
    ‚ñ∑ (H ‚üù `‚ô° x, not (VRAI and P) => R) ‚§≥
    ‚ñ∑ (H ‚üù (`‚ô¢ x, not P) => R)
  );

symbol NRM15 [H : El (list prd)] [P R : El prd] :
  El (
    ‚ñ∑ (H ‚üù `‚ô° x, not (VRAI and not P) => R) ‚§≥
    ‚ñ∑ (H ‚üù (`‚ô¢ x, P) => R)
  );

symbol NRM16 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [Q : El prd] :
  El (
    Prf (elem (! P) H) ‚§≥
    ‚ñ∑ (H ‚üù Q) ‚§≥
    ‚ñ∑ (H ‚üù (‚ô° P) => Q)
  );

// hopefully higher-order unification sorts this out
symbol NRM17 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [Q : El prd] [E : El exp] :
  El (
    Prf (elem (`! x, not (VRAI and P x)) H) ‚§≥
    ‚ñ∑ (H ‚üù (`‚ô° y, not (VRAI and not (P E))) => Q)
  );

symbol NRM18 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [R Q : El prd] [E : El exp] :
  El (
    Prf (elem (`! x, not (VRAI and not (P x))) H) ‚§≥
    Prf (P E ‚âà R) ‚§≥
    ‚ñ∑ (H ‚üù (`‚ô° y, not (VRAI and R)) => Q)
  );

symbol NRM19 [H : El (list prd)] [R : El (exp ‚§≥ prd)] [P Q : El prd] [E : El exp] :
  El (
    Prf (elem P H) ‚§≥
    Prf ((R E) ‚âà P) ‚§≥
    ‚ñ∑ (H ‚üù (`‚ô° x, not (VRAI and (R x))) => Q)
  );

symbol NRM20 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [Q : El prd] [E : El exp] :
  El (
    ‚ñ∑ (H ‚üù `‚ô° y, not (P E) => Q) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, `‚ô° y, not (P x and (E = x)) => Q)
  );

symbol NRM21 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [Q : El prd] [E : El exp] :
  El (
    ‚ñ∑ (H ‚üù `‚ô° y, not (P E) => Q) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, `‚ô° y, not (P x and (x = E)) => Q)
  );

symbol NRM22 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [Q : El prd] [E : El exp] :
  El (
    ‚ñ∑ (H ‚üù not (P E) => Q) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, not (P x and (x = E)) => Q)
  );

symbol NRM23 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [Q : El prd] [E : El exp] :
  El (
    ‚ñ∑ (H ‚üù not (P E) => Q) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, not (P x and (E = x)) => Q)
  );

sequential symbol NRM24_aux : El (prd ‚§≥ bool);

rule NRM24_aux ($A and $B) ‚Ü™ ‚ä•
with NRM24_aux  _          ‚Ü™ ‚ä•;

symbol NRM24 [H : El (list prd)] [P Q : El prd] :
  El (
    Prf (NRM24_aux P) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, not (VRAI and P) => Q) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, not P => Q)
  );

symbol NRM25 [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, P)
  );

symbol NRM26 [H : El (list prd)] [P : El (exp ‚§≥ prd)] :
  El (
    ‚ñ∑ (H ‚üù `‚ô° x, P x) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, `‚ô° y, P x)
  );

// ---- not yet implemented, possibly requires manipulation of variables? ------
symbol NRM27 [H : El (list prd)] [P Q : El prd] : TYPE;

symbol NRM29 [H : El (list prd)] [P Q S R : El prd] [a b : El exp] : TYPE;

symbol NRM29_1 [H : El (list prd)] [P Q S R : El prd] [a b : El exp] : TYPE;
// -----------------------------------------------------------------------------

symbol NRM30 [H : El (list prd)] [P' : El (exp ‚§≥ prd)] [S R : El prd] [a b x : El exp] :
  El (
    Prf (elem ((a + x) ‚â§ ùüé) (to_list (P' x))) ‚§≥
    Prf (elem ((b - x) ‚â§ ùüé) (to_list (P' x))) ‚§≥
    Prf (ev (a + b = ùüé)) ‚§≥
    ‚ñ∑ (H ‚üù not (P' b) => R) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, not (P' x) => R)
  );

symbol NRM30_1 [H : El (list prd)] [P' : El (exp ‚§≥ prd)] [S R : El prd] [a b x : El exp] :
  El (
    Prf (elem ((x + a) ‚â§ ùüé)   (to_list (P' x))) ‚§≥
    Prf (elem ((‚®™ x + b) ‚â§ ùüé) (to_list (P' x))) ‚§≥
    Prf (ev (a + b = ùüé)) ‚§≥
    ‚ñ∑ (H ‚üù not (P' b) => R) ‚§≥
    ‚ñ∑ (H ‚üù `‚ô° x, not (P' x) => R)
  );

// redunant rules??
symbol NRM8_1 : TYPE;
symbol NRM9_1 : TYPE;


// ----------------------------------------------
// 5.13. Rules for equality
// ----------------------------------------------
symbol EVR1 [H : El (list prd)] [P : El prd] [E : El exp] :
  El (
    ‚ñ∑ (H ‚üù not (E = E) => P)
  );

symbol EVR11 [H : El (list prd)] [P : El prd] [n m : El exp] :
  El (
    Prf (ev (n != m)) ‚§≥
    Prf (n ‚àà ‚Ñï) ‚§≥
    Prf (m ‚àà ‚Ñï) ‚§≥
    ‚ñ∑ (H ‚üù (n = m) => P)
  );

symbol EVR2 [H : El (list prd)] [E : El exp] :
  El (
    ‚ñ∑ (H ‚üù FAUX) ‚§≥
    ‚ñ∑ (H ‚üù not (E = E))
  );

symbol EVR3 [H : El (list prd)] [P : El prd] [E : El exp] :
  El (
    ‚ñ∑ (H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù (E = E) => P)
  );

symbol EVR4 [H : El (list prd)] [E : El exp] :
  El (
    ‚ñ∑ (H ‚üù (E = E))
  );

symbol EAXM1 [H : El (list prd)] [E F : El exp] [P : El prd] :
  El (
    Prf (elem (not (F = E)) H) ‚§≥
    ‚ñ∑ (H ‚üù (E = F) => P)
  );

symbol EAXM2 [H : El (list prd)] [E F : El exp] [P : El prd] :
  El (
    Prf (elem (F = E) H) ‚§≥
    ‚ñ∑ (H ‚üù not (E = F) => P)
  );

symbol EAXM3_1 [H : El (list prd)] [E F : El exp] [P : El prd] :
  El (
    Prf (elem (F = E) H) ‚§≥
    ‚ñ∑ (H ‚üù (E = F))
  );

symbol EAXM3_2 [H : El (list prd)] [E F : El exp] [P : El prd] :
  El (
    Prf (elem (not (F = E)) H) ‚§≥
    ‚ñ∑ (H ‚üù not (E = F))
  );

symbol EIMP5_1 [H : El (list prd)] [E F : El exp] [P : El prd] :
  El (
    Prf (elem (not (F = E)) H) ‚§≥
    ‚ñ∑ (H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù not (E = F) => P)
  );

symbol EIMP5_2 [H : El (list prd)] [E F : El exp] [P : El prd] :
  El (
    Prf (elem (F = E) H) ‚§≥
    ‚ñ∑ (H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù (E = F) => P)
  );

symbol EQC1 [H : El (list prd)] [a b c d : El exp] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù not (a = c) or not (b = d) => P) ‚§≥
    ‚ñ∑ (H ‚üù not (opair a b = opair c d) => P)
  );

symbol EQC2 [H : El (list prd)] [a b c d : El exp] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù (a = c) and (b = d) => P) ‚§≥
    ‚ñ∑ (H ‚üù  (opair a b = opair c d) => P)
  );

symbol EQS1 [H : El (list prd)] [E F : El exp] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù (E = F) => P) ‚§≥
    ‚ñ∑ (H ‚üù (eql_set E F) => P)
  );

symbol EQS2 [H : El (list prd)] [E F : El exp] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù FAUX => P) ‚§≥
    ‚ñ∑ (H ‚üù not (eql_set E F) => P)
  );

symbol EAXM9_1 [H : El (list prd)] [p q : El (exp ‚§≥ exp)] [E : El exp] [Q : El prd] :
  El (
    Prf (elem (`! x, not (VRAI and (p x = q x))) H) ‚§≥
    ‚ñ∑ (H ‚üù ((p E) = (q E)) => Q)
  );

symbol EAXM9_2 [H : El (list prd)] [p q : El (exp ‚§≥ exp)] [E : El exp] [Q : El prd] :
  El (
    Prf (elem (`! x, not (VRAI and not (p x = q x))) H) ‚§≥
    ‚ñ∑ (H ‚üù not ((p E) = (q E)) => Q)
  );

symbol OPR1 [H : El (list prd)] [P : El prd] [x : El idt] [E : El exp] :
  El (
    ‚ñ∑ (H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù (var x = E) => P)
  );

symbol OPR2 [H : El (list prd)] [P : El (exp ‚§≥ prd)] [x E : El exp] :
  El (
    ‚ñ∑ (H ‚üù P E) ‚§≥
    ‚ñ∑ (H ‚üù (E = x) => P x)
  );

symbol ECTR1 [H : El (list prd)] [P : El prd] [Q : El (exp ‚§≥ prd)] [E F : El exp] :
  El (
    Prf (elem (not (Q E)) H) ‚§≥
    Prf (elem (Q F) H) ‚§≥
    ‚ñ∑ (H ‚üù (E = F) => P)
  );

symbol ECTR2 [H : El (list prd)] [P : El prd] [Q : El (exp ‚§≥ prd)] [E F : El exp] :
  El (
    Prf (elem (not (Q E)) H) ‚§≥
    Prf (elem (Q F) H) ‚§≥
    ‚ñ∑ (H ‚üù (F = E) => P)
  );

symbol ECTR3 [H : El (list prd)] [Q : El prd] [P : El (exp ‚§≥ prd)] [E F : El exp] :
  El (
    Prf (elem (E = F) H) ‚§≥
    Prf (elem (P F) H) ‚§≥
    ‚ñ∑ (H ‚üù not (P E) => Q)
  );

symbol ECTR4 [H : El (list prd)] [Q : El prd] [P : El (exp ‚§≥ prd)] [E F : El exp] :
  El (
    Prf (elem (F = E) H) ‚§≥
    Prf (elem (P F) H) ‚§≥
    ‚ñ∑ (H ‚üù not (P E) => Q)
  );

symbol ECTR5 [H : El (list prd)] [Q : El prd] [P : El (exp ‚§≥ prd)] [E F : El exp] :
  El (
    Prf (elem (E = F) H) ‚§≥
    Prf (elem (not (P F)) H) ‚§≥
    ‚ñ∑ (H ‚üù P E => Q)
  );

symbol ECTR6 [H : El (list prd)] [Q : El prd] [P : El (exp ‚§≥ prd)] [E F : El exp] :
  El (
    Prf (elem (F = E) H) ‚§≥
    Prf (elem (not (P F)) H) ‚§≥
    ‚ñ∑ (H ‚üù P E => Q)
  );


// ----------------------------------------------
// 5.14. Rules for arithmetic
// ----------------------------------------------
symbol AR1 [H : El (list prd)] [E : El exp] [R : El prd] :
  El (
    ‚ñ∑ (H ‚üù R) ‚§≥
    ‚ñ∑ (H ‚üù (E ‚â§ E) => R)
  );

symbol AR2 [a b : El exp] [H : El (list prd)] [R : El prd] :
  El (
    Prf (ev (a > b)) ‚§≥
    ‚ñ∑ (H ‚üù a ‚â§ b => R)
  );

symbol AR3 [a : El exp] [H : El (list prd)] [R : El prd] :
  El (
    ‚ñ∑ (H ‚üù ((ùüè - a) ‚â§ ùüé) => R) ‚§≥
    ‚ñ∑ (H ‚üù not (a ‚â§ ùüé) => R)
  );

symbol AR4 [E F : El exp] [H : El (list prd)] [R : El prd] :
  El (
    Prf (elem (F ‚â§ ùüé) H) ‚§≥
    Prf (ev ((E + F) > ùüé)) ‚§≥
    ‚ñ∑ (H ‚üù E ‚â§ ùüé => R)
  );

symbol AR5 [a : El exp] [H : El (list prd)] [R : El prd] :
  El (
    Prf (elem (a ‚â™ ùüé) H) ‚§≥
    ‚ñ∑ (H ‚üù (a = ùüé => (‚®™ a ‚â§ ùüé => R))) ‚§≥
    ‚ñ∑ (H ‚üù ‚®™ a ‚â§ ùüé => R)
  );

symbol AR6 [a : El exp] [H : El (list prd)] [R : El prd] :
  El (
    Prf (elem (‚®™ a ‚â™ ùüé) H) ‚§≥
    ‚ñ∑ (H ‚üù (a = ùüé => (a ‚â§ ùüé => R))) ‚§≥
    ‚ñ∑ (H ‚üù a ‚â§ ùüé => R)
  );

symbol AR7 [a b c : El exp] [H : El (list prd)] [R : El prd] :
  El (
    Prf (elem ((c + b) ‚â™ ùüé) H) ‚§≥
    Prf (ev ((a + c) = ùüé)) ‚§≥
    ‚ñ∑ (H ‚üù (a = b) => ((a - b) ‚â§ ùüé) => R) ‚§≥
    ‚ñ∑ (H ‚üù ((a - b) ‚â§ ùüé) => R)
  );

symbol AR8 [a b c : El exp] [H : El (list prd)] [R : El prd] :
  El (
    Prf (elem ((a - b) ‚â™ ùüé) H) ‚§≥
    Prf (ev ((a + c) = ùüé)) ‚§≥
    ‚ñ∑ (H ‚üù (a = b) => ((c + b) ‚â§ ùüé) => R) ‚§≥
    ‚ñ∑ (H ‚üù ((c + b) ‚â§ ùüé) => R)
  );

symbol AR9 [E F : El exp] [H : El (list prd)] [R : El prd] :
  El (
    Prf (ev E ‚âà F) ‚§≥
    ‚ñ∑ (H ‚üù (F ‚â§ ùüé) => R) ‚§≥
    ‚ñ∑ (H ‚üù (E ‚â§ ùüé) => R)
  );

symbol AR10 [H : El (list prd)] [P Q R : El prd] :
  El (
    Prf (ev P ‚âà Q) ‚§≥
    ‚ñ∑ (H ‚üù Q => R) ‚§≥
    ‚ñ∑ (H ‚üù P => R)
  );

symbol AR11 [x : El exp] [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ (H ‚üù not (x ‚â§ x) => P)
  );

symbol AR12 [a b : El exp] [H : El (list prd)] [P : El prd] :
  El (
    ‚ñ∑ ((a ‚â§ b) ‚à∑ H ‚üù (a ‚â§ b) => P)
  );


// ----------------------------------------------
// 5.15 Booleans
// ----------------------------------------------
// in contrast to `VRAI` and `FAUX` in `VRFX` (both of type `prd`),
// the rules in this file operate on boolean values of type `exp`.
// ----------------------------------------------
symbol FALSE : El exp;
symbol TRUE : El exp;

symbol BOOL1_1 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ ((not (v = FALSE)) ‚à∑ (v = TRUE) ‚à∑ H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù (v = TRUE) => P)
  );

symbol BOOL1_2 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ ((v = FALSE) ‚à∑ (not (v = TRUE)) ‚à∑ H ‚üù P) ‚§≥
    ‚ñ∑ (H ‚üù (v = FALSE) => P)
  );

symbol BOOL2_1 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ (H ‚üù (v = TRUE) => P) ‚§≥
    ‚ñ∑ (H ‚üù (TRUE = v) => P)
  );

symbol BOOL2_2 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ (H ‚üù (v = FALSE) => P) ‚§≥
    ‚ñ∑ (H ‚üù (FALSE = v) => P)
  );

symbol BOOL3_1 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ (H ‚üù (v = FALSE) => P) ‚§≥
    ‚ñ∑ (H ‚üù not (v = TRUE) => P)
  );

symbol BOOL3_2 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ (H ‚üù (v = TRUE) => P) ‚§≥
    ‚ñ∑ (H ‚üù not (v = FALSE) => P)
  );

symbol BOOL4_1 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ (H ‚üù (v = FALSE) => P) ‚§≥
    ‚ñ∑ (H ‚üù not (TRUE = v) => P)
  );

symbol BOOL4_2 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ (H ‚üù (v = TRUE) => P) ‚§≥
    ‚ñ∑ (H ‚üù not (FALSE = v) => P)
  );

symbol BOOL5_1 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ (H ‚üù (TRUE = FALSE) => P)
  );

symbol BOOL5_2 [H : El (list prd)] [P : El prd] [v : El exp] :
  El (
    ‚ñ∑ (H ‚üù (FALSE = TRUE) => P)
  );
